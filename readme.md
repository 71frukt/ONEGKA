# Прогамма сортировки текста различными способами

Автор

Шелонин Арсений

1 курс | Б01-411

## Запуск программы
 ### Расположение файлов и папок
 В одной папке должны лежать два исполняемых файла: main.exe и format_file.exe, а также папка texts, в которую необходимо положить обрабатываемые файлы.

 ## Как вызвать программу
 Перед основной работой с текстом файла его необходимо отформатировать с помощью программы format_file.exe, запустив её в консоли и написав после имени программы:
 1. имя оригинального файла
 2. имя файла, в который запишется отформатированный текст


 Затем для работы главной программы необходимо запустить файл main.exe, написав после имени программы:
 1. имя отформатированного файла
 2. имя файла, в который запишется результат работы программы

 например, `... .\format_file.exe orig_text.txt format_text.txt`
 или `... .\main.exe format_text.txt sort_text.txt`

 если не написать второй аргумент, то файлы для записи создадутся сами с стандартными именами.


## Суть программы
 
 ### Описание работы
  #### Форматировщик
  Программа format_file открывает указанный пользователем файл, считывает оттуда  текст и форматирует его для корректной работы программы main, убирая все лишние символы. В итоге она записывает отформатированный текст во второй указанный файл.

  #### Сортировщик
  Программа main.exe считывает текст из указанного пользователем файла, сортирует его двумя способами: сравнивая строки с начала (результат по алфавиту) и с конца (результат по рифме) . Два полученных она записывает во второй указанный файл, затем выводит туда и оригинальный текст.
  
  убирая все лишние символы перед началом строки и между строками (пробелы, точки и т.п.) . Также в неё встроен алгоритм отбрасывания номеров глав латинскими цифрами (римские цифры отбрасываются автоматически как небуквенные символы) .

## Подробное описание работы
 #### Форматировщик
 Форматировщик удаляет все лишние символы перед и между строчками (точки, пробелы и т.п.), а также в него встроен алгоритм отбрасывания номеров глав латинскими цифрами SkipRomanDigits (римские цифры отбрасываются автоматически как небуквенные символы) .

 #### Сортировщик
 Сортировщик открывает два файла через функцию `OpenGettedFiles()`, которая заходит в папку texts и открывает там файлы с именами, которые ввёл пользователь. Каждый файл обрабатывает функция `ReadFile`, которая получает данные о файле и выделяет память для текста файла, а также функцией `SetEndsOfLines()` на месте каждого символа новой строки '\n' ставит символ конца строки '\0'.

 Затем функция `GetTextInfo()` записывает данные о тексте в структуру TextInfo, одним из элементов которой является указатель на перввый элемент массива линий (про линии - дальше)
 ```C
 struct TextInfo
 {
    size_t length;          // длина текста 
    char *text_cont;        // указатель на первый символ текста

    size_t num_lines;       // количество строк
    Line **p_lines;         // указатель на первую линию 
 };
 ```

Массив структур Line выделяется в динамической памяти функцией Calloc_Ptr_Lines()

```C
 struct Line
{
    char *line_cont;        // указатель на первый элемент строки
    int length;             // длина строки
};
```

Для быстродействия и выгодного использования памяти сортируются не строки, а указатели на них. В обратной сортировке активно используется длина строки, поэтому, чтобы не вызывать каждый раз strlen(), в структуре Line лежит длина строки.

Для создания массива указателей на начала строк Line **p_lines используется функция `PutPointers()`. Она находит символы '\0' и ставит указатель на следующий после них символ. Так каждый указатель (кроме самого первого) представляет собой строку. Самый первый указатель выставляется вручную.

Перед сортировкой оригинальные данные копируются в ещё одну переменную типа TextIndo посредством функции `CopyTextInfos()` копирующей все поля одной структуры в другую и выделяющей динамическую память для массивов.

Для сравнения строк используются компараторы `StrCompare()` и `StrReverceCompare()`, принимающие как параметр две структуры Line.

Для сортировки используется алгоритм быстрой сортировки `MyQSort()`. Т.к. эта функция принимает void*, она универсальна, т.е. может сортировать буквально любой массив в зависимости от компаратора, который она также принимает как аргумент.

Затем функция `FprintText()` выводит отсортированные в прямом, обратном и оригинальном порядке указанный файл.

В завершение вызывается функция `FreeTextInfo()` для всех переменных типа TextInfo, чтобы очистить выделенную для них динамическую память.
